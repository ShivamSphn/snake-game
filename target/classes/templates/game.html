<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Snake Game</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Arial', sans-serif;
        }
        canvas {
            border: 3px solid #4ecca3;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(78, 204, 163, 0.3);
        }
        #score {
            color: #4ecca3;
            font-size: 28px;
            margin: 20px 0;
            text-shadow: 0 0 10px rgba(78, 204, 163, 0.5);
        }
        #gameOver {
            display: none;
            color: #ff2e63;
            font-size: 36px;
            margin: 20px 0;
            text-shadow: 0 0 10px rgba(255, 46, 99, 0.5);
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        #restartButton {
            display: none;
            padding: 12px 24px;
            font-size: 20px;
            background: #4ecca3;
            color: #1a1a2e;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(78, 204, 163, 0.4);
        }
        #restartButton:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(78, 204, 163, 0.6);
        }
    </style>
</head>
<body>
    <div id="score">Score: 0</div>
    <canvas id="gameCanvas" width="600" height="600"></canvas>
    <div id="gameOver">Game Over!</div>
    <button id="restartButton">Play Again</button>

    <script>
        class Tile {
            constructor(x, y) {
                this.x = x;
                this.y = y;
            }
        }

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const gameOverElement = document.getElementById('gameOver');
        const restartButton = document.getElementById('restartButton');

        const tileSize = 25;
        const boardWidth = canvas.width;
        const boardHeight = canvas.height;

        let snake;
        let food;
        let velocityX;
        let velocityY;
        let gameLoop;
        let score;
        let gameOver;

        function drawApple(x, y) {
            ctx.save();
            ctx.fillStyle = '#ff2e63';
            ctx.beginPath();
            ctx.arc(x * tileSize + tileSize/2, y * tileSize + tileSize/2, tileSize/2 - 2, 0, Math.PI * 2);
            ctx.fill();
            // Draw leaf
            ctx.fillStyle = '#4ecca3';
            ctx.beginPath();
            ctx.ellipse(x * tileSize + tileSize/2, y * tileSize + 2, tileSize/6, tileSize/4, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        }

        function drawSnakeSegment(x, y, isHead) {
            ctx.save();
            if (isHead) {
                // Snake head
                ctx.fillStyle = '#4ecca3';
                ctx.beginPath();
                ctx.roundRect(x * tileSize, y * tileSize, tileSize - 2, tileSize - 2, 8);
                ctx.fill();
                
                // Eyes
                ctx.fillStyle = '#1a1a2e';
                let eyeX1, eyeX2, eyeY;
                if (velocityX === 1) {
                    eyeX1 = x * tileSize + tileSize - 8;
                    eyeX2 = eyeX1;
                    eyeY = y * tileSize + 6;
                } else if (velocityX === -1) {
                    eyeX1 = x * tileSize + 4;
                    eyeX2 = eyeX1;
                    eyeY = y * tileSize + 6;
                } else if (velocityY === 1) {
                    eyeX1 = x * tileSize + 6;
                    eyeX2 = x * tileSize + tileSize - 8;
                    eyeY = y * tileSize + tileSize - 8;
                } else {
                    eyeX1 = x * tileSize + 6;
                    eyeX2 = x * tileSize + tileSize - 8;
                    eyeY = y * tileSize + 4;
                }
                ctx.beginPath();
                ctx.arc(eyeX1, eyeY, 2, 0, Math.PI * 2);
                ctx.arc(eyeX2, eyeY + (velocityX !== 0 ? 8 : 0), 2, 0, Math.PI * 2);
                ctx.fill();
            } else {
                // Snake body
                ctx.fillStyle = '#45b08c';
                ctx.beginPath();
                ctx.roundRect(x * tileSize, y * tileSize, tileSize - 2, tileSize - 2, 4);
                ctx.fill();
            }
            ctx.restore();
        }

        function initGame() {
            snake = [new Tile(5, 5)];
            food = new Tile(10, 10);
            velocityX = 1;
            velocityY = 0;
            score = 0;
            gameOver = false;
            
            gameOverElement.style.display = 'none';
            restartButton.style.display = 'none';
            scoreElement.textContent = 'Score: 0';
            
            placeFood();
            if (gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(update, 100);
        }

        function placeFood() {
            food.x = Math.floor(Math.random() * (boardWidth / tileSize));
            food.y = Math.floor(Math.random() * (boardHeight / tileSize));
            
            // Ensure food doesn't appear on snake
            for (let part of snake) {
                if (part.x === food.x && part.y === food.y) {
                    placeFood();
                    break;
                }
            }
        }

        function update() {
            if (gameOver) return;

            // Move snake body
            for (let i = snake.length - 1; i > 0; i--) {
                snake[i] = new Tile(snake[i-1].x, snake[i-1].y);
            }

            // Move snake head
            snake[0] = new Tile(
                snake[0].x + velocityX,
                snake[0].y + velocityY
            );

            // Check wall collision
            if (snake[0].x < 0 || snake[0].x >= boardWidth/tileSize ||
                snake[0].y < 0 || snake[0].y >= boardHeight/tileSize) {
                endGame();
                return;
            }

            // Check self collision
            for (let i = 1; i < snake.length; i++) {
                if (snake[0].x === snake[i].x && snake[0].y === snake[i].y) {
                    endGame();
                    return;
                }
            }

            // Check food collision
            if (snake[0].x === food.x && snake[0].y === food.y) {
                snake.push(new Tile(food.x, food.y));
                score++;
                scoreElement.textContent = `Score: ${score}`;
                placeFood();
            }

            draw();
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, boardWidth, boardHeight);

            // Draw grid
            ctx.strokeStyle = '#232344';
            for (let i = 0; i < boardWidth/tileSize; i++) {
                ctx.beginPath();
                ctx.moveTo(i * tileSize, 0);
                ctx.lineTo(i * tileSize, boardHeight);
                ctx.stroke();
                
                ctx.beginPath();
                ctx.moveTo(0, i * tileSize);
                ctx.lineTo(boardWidth, i * tileSize);
                ctx.stroke();
            }

            // Draw food
            drawApple(food.x, food.y);

            // Draw snake
            for (let i = snake.length - 1; i >= 0; i--) {
                drawSnakeSegment(snake[i].x, snake[i].y, i === 0);
            }
        }

        function endGame() {
            gameOver = true;
            clearInterval(gameLoop);
            gameOverElement.style.display = 'block';
            restartButton.style.display = 'block';
        }

        document.addEventListener('keydown', (e) => {
            if (gameOver) return;

            switch(e.key) {
                case 'ArrowUp':
                    if (velocityY !== 1) {
                        velocityX = 0;
                        velocityY = -1;
                    }
                    break;
                case 'ArrowDown':
                    if (velocityY !== -1) {
                        velocityX = 0;
                        velocityY = 1;
                    }
                    break;
                case 'ArrowLeft':
                    if (velocityX !== 1) {
                        velocityX = -1;
                        velocityY = 0;
                    }
                    break;
                case 'ArrowRight':
                    if (velocityX !== -1) {
                        velocityX = 1;
                        velocityY = 0;
                    }
                    break;
            }
        });

        restartButton.addEventListener('click', initGame);

        // Start the game
        initGame();
    </script>
</body>
</html>
